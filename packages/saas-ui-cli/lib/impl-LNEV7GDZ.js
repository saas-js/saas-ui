import{a as h}from"./chunk-VMHSPGPO.js";import{b as o,e as l,h as y,i as r,j as u}from"./chunk-SRHFU3RL.js";import{promises as w}from"fs";import p from"path";import{z as g}from"zod";var x=g.object({cwd:g.string(),silent:g.boolean(),remove:g.boolean()});async function O(d,...v){try{let e=x.parse({...d,cwd:p.resolve(d.cwd??process.cwd())}),[s,m]=v;e.remove?(s||(r.error("Registry name is required."),process.exit(1)),m&&r.warn("URL parameter is ignored when using --remove flag.")):(!s||!m)&&(r.error("Both registry name and URL are required."),process.exit(1));let t=s.startsWith("@")?s:`@${s}`,i=await y(e.cwd);i||(r.error(`No ${o.info("components.json")} found. Please run ${o.info("init")} first.`),process.exit(1));let n;if(e.remove){i.registries?.[t]||(r.error(`Registry ${o.info(t)} not found in components.json.`),process.exit(1));let{[t]:a,...c}=i.registries;n={...i,registries:c}}else n={...i,registries:{...i.registries,[t]:{url:m}}};if(l.parse(n),e.silent){let a=p.resolve(e.cwd,"components.json");await w.writeFile(a,JSON.stringify(n,null,2),"utf8")}else{let a=e.remove?"Removing":i.registries?.[t]?"Updating":"Adding",c=h(`${a} registry ${o.info(t)}...`).start();try{let f=p.resolve(e.cwd,"components.json");await w.writeFile(f,JSON.stringify(n,null,2),"utf8"),c.succeed()}catch(f){throw c.fail(),f}}r.break();let R=e.remove?"removed":i.registries?.[t]?"updated":"added";r.log(`${o.success("Success!")} Registry ${o.info(t)} has been ${R}.`),r.break()}catch(e){r.break(),u(e)}}export{O as registry};
//# sourceMappingURL=impl-LNEV7GDZ.js.map