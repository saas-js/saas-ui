{"version":3,"sources":["../src/commands/list/impl.ts"],"sourcesContent":["import Table from 'cli-table3'\nimport kleur from 'kleur'\nimport z from 'zod'\n\nimport type { LocalContext } from '#context'\nimport { handleError } from '#utils/handle-error'\nimport { logger } from '#utils/logger'\nimport { getRegistryIndex } from '#utils/registry'\n\nconst listOptionsSchema = z.object({\n  category: z.string().optional(),\n  search: z.string().optional(),\n})\n\ntype ListCommandFlags = z.infer<typeof listOptionsSchema>\n\nexport async function list(this: LocalContext, flags: ListCommandFlags) {\n  try {\n    const parsedFlags = listOptionsSchema.parse(flags)\n    const registryIndex = await getRegistryIndex()\n\n    if (!registryIndex) {\n      logger.error('Failed to fetch registry index.')\n      return\n    }\n\n    const table = new Table({\n      head: ['Name', 'Category', 'Description'],\n      colWidths: [35, 15, 60],\n      style: {\n        head: ['cyan'],\n        border: ['gray'],\n      },\n    })\n\n    let components = registryIndex.filter((component) =>\n      ['registry:ui', 'registry:block'].includes(component.type),\n    )\n\n    if (parsedFlags.category) {\n      components = components.filter((component) =>\n        component.subcategory\n          ?.toLowerCase()\n          .includes(parsedFlags.category!.toLowerCase()),\n      )\n    }\n\n    if (parsedFlags.search) {\n      const searchTerm = parsedFlags.search.toLowerCase()\n      components = components.filter(\n        (component) =>\n          component.name.toLowerCase().includes(searchTerm) ||\n          component.description?.toLowerCase().includes(searchTerm) ||\n          component.category?.toLowerCase().includes(searchTerm) ||\n          component.subcategory?.toLowerCase().includes(searchTerm),\n      )\n    }\n\n    components = components.sort((a, b) => {\n      if (a.subcategory !== b.subcategory) {\n        return a.subcategory?.localeCompare(b.subcategory || '') || 0\n      }\n      return a.name.localeCompare(b.name)\n    })\n\n    for (const component of components) {\n      const name = component.private\n        ? `${component.name} ${kleur.blue(kleur.bold('(PRO)'))}`\n        : component.name\n\n      table.push([\n        name,\n        component.subcategory || '-',\n        component.description || '-',\n      ])\n    }\n\n    logger.log('')\n\n    let title = 'Available Components:'\n    const filters = []\n    if (parsedFlags.category) {\n      filters.push(`subcategory: ${parsedFlags.category}`)\n    }\n    if (parsedFlags.search) {\n      filters.push(`search: \"${parsedFlags.search}\"`)\n    }\n\n    if (filters.length > 0) {\n      title += ` (filtered by ${filters.join(', ')})`\n    }\n\n    logger.log(kleur.bold(title))\n    logger.log('')\n    logger.log(table.toString())\n    logger.log('')\n    logger.log(`Total: ${kleur.green(components.length)} components`)\n    logger.log('')\n  } catch (error) {\n    handleError(error)\n  }\n}\n"],"mappings":"kFAAA,OAAOA,MAAW,aAClB,OAAOC,MAAW,QAClB,OAAOC,MAAO,MAOd,IAAMC,EAAoBC,EAAE,OAAO,CACjC,SAAUA,EAAE,OAAO,EAAE,SAAS,EAC9B,OAAQA,EAAE,OAAO,EAAE,SAAS,CAC9B,CAAC,EAID,eAAsBC,EAAyBC,EAAyB,CACtE,GAAI,CACF,IAAMC,EAAcJ,EAAkB,MAAMG,CAAK,EAC3CE,EAAgB,MAAMC,EAAiB,EAE7C,GAAI,CAACD,EAAe,CAClBE,EAAO,MAAM,iCAAiC,EAC9C,MACF,CAEA,IAAMC,EAAQ,IAAIC,EAAM,CACtB,KAAM,CAAC,OAAQ,WAAY,aAAa,EACxC,UAAW,CAAC,GAAI,GAAI,EAAE,EACtB,MAAO,CACL,KAAM,CAAC,MAAM,EACb,OAAQ,CAAC,MAAM,CACjB,CACF,CAAC,EAEGC,EAAaL,EAAc,OAAQM,GACrC,CAAC,cAAe,gBAAgB,EAAE,SAASA,EAAU,IAAI,CAC3D,EAUA,GARIP,EAAY,WACdM,EAAaA,EAAW,OAAQC,GAC9BA,EAAU,aACN,YAAY,EACb,SAASP,EAAY,SAAU,YAAY,CAAC,CACjD,GAGEA,EAAY,OAAQ,CACtB,IAAMQ,EAAaR,EAAY,OAAO,YAAY,EAClDM,EAAaA,EAAW,OACrBC,GACCA,EAAU,KAAK,YAAY,EAAE,SAASC,CAAU,GAChDD,EAAU,aAAa,YAAY,EAAE,SAASC,CAAU,GACxDD,EAAU,UAAU,YAAY,EAAE,SAASC,CAAU,GACrDD,EAAU,aAAa,YAAY,EAAE,SAASC,CAAU,CAC5D,CACF,CAEAF,EAAaA,EAAW,KAAK,CAACG,EAAGC,IAC3BD,EAAE,cAAgBC,EAAE,YACfD,EAAE,aAAa,cAAcC,EAAE,aAAe,EAAE,GAAK,EAEvDD,EAAE,KAAK,cAAcC,EAAE,IAAI,CACnC,EAED,QAAWH,KAAaD,EAAY,CAClC,IAAMK,EAAOJ,EAAU,QACnB,GAAGA,EAAU,IAAI,IAAIK,EAAM,KAAKA,EAAM,KAAK,OAAO,CAAC,CAAC,GACpDL,EAAU,KAEdH,EAAM,KAAK,CACTO,EACAJ,EAAU,aAAe,IACzBA,EAAU,aAAe,GAC3B,CAAC,CACH,CAEAJ,EAAO,IAAI,EAAE,EAEb,IAAIU,EAAQ,wBACNC,EAAU,CAAC,EACbd,EAAY,UACdc,EAAQ,KAAK,gBAAgBd,EAAY,QAAQ,EAAE,EAEjDA,EAAY,QACdc,EAAQ,KAAK,YAAYd,EAAY,MAAM,GAAG,EAG5Cc,EAAQ,OAAS,IACnBD,GAAS,iBAAiBC,EAAQ,KAAK,IAAI,CAAC,KAG9CX,EAAO,IAAIS,EAAM,KAAKC,CAAK,CAAC,EAC5BV,EAAO,IAAI,EAAE,EACbA,EAAO,IAAIC,EAAM,SAAS,CAAC,EAC3BD,EAAO,IAAI,EAAE,EACbA,EAAO,IAAI,UAAUS,EAAM,MAAMN,EAAW,MAAM,CAAC,aAAa,EAChEH,EAAO,IAAI,EAAE,CACf,OAASY,EAAO,CACdC,EAAYD,CAAK,CACnB,CACF","names":["Table","kleur","z","listOptionsSchema","z","list","flags","parsedFlags","registryIndex","getRegistryIndex","logger","table","Table","components","component","searchTerm","a","b","name","kleur","title","filters","error","handleError"]}